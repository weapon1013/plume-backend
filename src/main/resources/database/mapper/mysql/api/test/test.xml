<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<!--
<mapper namespace="com.plume.craft.api.alarm.repository.AlarmRepository">
-->

	<!-- 알람 조회 -->
<!--	<select id="selectAlarmListPage" resultType="com.mtis21.craft.api.alarm.domain.vo.AlarmVO">-->
<!--		/*AlarmRepository.selectAlarmListPage*/-->
<!--		SELECT-->
<!--			ALM.ALARM_SEQ-->
<!--			, ALM.ROBOT_SEQ-->
<!--			, RBT.ROBOT_NM-->
<!--			, ALM.ALARM_CD-->
<!--			, ALN.ALARM_TYPE-->
<!--			, ALN.ALARM_ICON-->
<!--			, ALLT.ALARM_TXT-->
<!--			, ALM.ALARM_PARAM-->
<!--			, CASE-->
<!--				WHEN ALC.USER_SEQ IS NULL THEN 'N'-->
<!--				ELSE 'Y'-->
<!--			END AS READ_YN-->
<!--			, ALM.REG_DT-->
<!--		FROM RY_ALARM ALM-->
<!--		JOIN RY_ALARM_LANGUAGE ALN ON ALM.ALARM_CD = ALN.ALARM_CD-->
<!--		JOIN RY_ROBOT RBT ON ALM.ROBOT_SEQ = RBT.ROBOT_SEQ-->
<!--		JOIN RY_ALARM_LANGUAGE_TXT ALLT  ON ALM.ALARM_CD = ALLT.ALARM_CD-->
<!--		LEFT OUTER JOIN RY_ALARM_CHECK ALC ON ALM.ALARM_SEQ = ALC.ALARM_SEQ-->
<!--		AND ALC.DEL_YN = 'N' AND ALC.USER_SEQ = #{userInfo.userSeq}-->
<!--		<if test="keyword != null">-->
<!--			JOIN (SELECT ALARM_SEQ, JSON_UNQUOTE(JSON_EXTRACT(ALARM_PARAM, '$.p1')) AS EXTRACT_VALUE FROM RY_ALARM) ST1 ON ST1.ALARM_SEQ = ALM.ALARM_SEQ-->
<!--			JOIN (SELECT ALARM_SEQ, JSON_UNQUOTE(JSON_EXTRACT(ALARM_PARAM, '$.p2')) AS EXTRACT_VALUE FROM RY_ALARM) ST2 ON ST2.ALARM_SEQ = ALM.ALARM_SEQ-->
<!--			JOIN (SELECT ALARM_SEQ, JSON_UNQUOTE(JSON_EXTRACT(ALARM_PARAM, '$.p3')) AS EXTRACT_VALUE FROM RY_ALARM) ST3 ON ST3.ALARM_SEQ = ALM.ALARM_SEQ-->
<!--		</if>-->
<!--		WHERE ALLT.ALARM_LANGUAGE = #{language}-->
<!--		AND ALM.ROBOT_SEQ IN (SELECT ROBOT_SEQ FROM RY_ROBOT WHERE ACTIVE_YN = 'Y' AND STORE_SEQ = #{userInfo.storeSeq})-->
<!--		<if test="storeSeq != null">-->
<!--			AND ALM.ROBOT_SEQ IN (SELECT ROBOT_SEQ FROM RY_ROBOT WHERE ACTIVE_YN = 'Y' AND STORE_SEQ = #{storeSeq})-->
<!--		</if>-->
<!--		<if test="robotSeq != null">-->
<!--			AND ALM.ROBOT_SEQ = #{robotSeq}-->
<!--		</if>-->
<!--		<if test="alarmType != null">-->
<!--			AND ALN.ALARM_TYPE = #{alarmType}-->
<!--		</if>-->
<!--		<choose>-->
<!--			<when test="startDt != null and endDt != null">-->
<!--				AND ALM.REG_DT BETWEEN #{startDt} AND #{endDt}-->
<!--			</when>-->
<!--			<when test="regDt != null">-->
<!--				AND DATE(ALM.REG_DT) = DATE(#{regDt})-->
<!--			</when>-->
<!--		</choose>-->
<!--		<if test="keyword != null">-->
<!--			AND (-->
<!--			ALLT.ALARM_TXT LIKE CONCAT('%', #{keyword}, '%')-->
<!--			OR ST1.EXTRACT_VALUE LIKE CONCAT('%', #{keyword}, '%')-->
<!--			OR ST2.EXTRACT_VALUE LIKE CONCAT('%', #{keyword}, '%')-->
<!--			OR ST3.EXTRACT_VALUE LIKE CONCAT('%', #{keyword}, '%')-->
<!--			)-->
<!--		</if>-->
<!--		ORDER BY ALM.REG_DT DESC-->
<!--	</select>-->

<mapper>

</mapper>